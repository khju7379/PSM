-- DROP PROCEDURE PSSCMLIB.PSM_PSM4040_SAFEORDER_COPY;
  
CREATE PROCEDURE PSSCMLIB.PSM_PSM4040_SAFEORDER_COPY ( 
	IN P_COPYDATE VARCHAR(8) , 
	IN P_NEW_SMWKORSEQ VARCHAR(3) , 
	IN P_SABUN VARCHAR(6) , 
	IN P_SMWKTEAM VARCHAR(6) , 
	IN P_SMWKDATE VARCHAR(8) , 
	IN P_SMWKSEQ NUMERIC(3, 0) , 
	IN P_SMWKORAPPDATE VARCHAR(8) , 
	IN P_SMWKORSEQ NUMERIC(3, 0) ) 
	LANGUAGE SQL 
	SPECIFIC PSSCMLIB.PSM_PSM4040_SAFEORDER_COPY 
	NOT DETERMINISTIC 
	MODIFIES SQL DATA 
	CALLED ON NULL INPUT 
	SET OPTION  ALWBLK = *ALLREAD , 
	ALWCPYDTA = *OPTIMIZE , 
	COMMIT = *NONE , 
	DECRESULT = (31, 31, 00) , 
	DYNDFTCOL = *NO , 
	DYNUSRPRF = *USER , 
	SRTSEQ = *HEX   
	P1 : BEGIN 
  
	INSERT INTO PSSCMLIB . PSM_SAFEORDER_MASTER 
	( 
		SMWKTEAM , 
		SMWKDATE , 
		SMWKSEQ , 
		SMWKORAPPDATE , 
		SMWKORSEQ , 
		SMMETHODCODE , 
		SMREVTEAM , 
		SMWKMETHOD , 
		SMSUBVEND , 
		SMSUBPERSON , 
		SMSUBTEL , 
		SMRESSABUN , 
		SMWKMAN , 
		SMTADATE1 , 
		SMTATIME1 , 
		SMTADATE2 , 
		SMTATIME2 , 
		SMOTDATE1 , 
		SMOTTIME1 , 
		SMOTDATE2 , 
		SMOTTIME2 , 
		SMOTAPPSABUN , 
		SMSYSTEMCODE1 , 
		SMSYSTEMCODE2 , 
		SMSYSTEMCODE3 , 
		SMSYSTEMCODE4 , 
		SMSYSTEMCODE5 , 
		SMCONNCODE11 , 
		SMCONNCODE12 , 
		SMCONNCODE21 , 
		SMCONNCODE22 , 
		SMCONNCODE31 , 
		SMCONNCODE32 , 
		SMCONNCODE41 , 
		SMCONNCODE42 , 
		SMCONNCODE51 , 
		SMCONNCODE52 , 
		SMAREACODE1 , 
		SMAREACODE2 , 
		SMAREACODE3 , 
		SMAREACODE4 , 
		SMAREACODE5 , 
		SMAREATEXT1 , 
		SMAREATEXT2 , 
		SMAREATEXT3 , 
		SMAREATEXT4 , 
		SMAREATEXT5 , 
		SMMATERTEXT1 , 
		SMMATERTEXT2 , 
		SMNOTE_BURN , 
		SMNOTE_SUFF , 
		SMNOTE_ELE , 
		SMNOTE_FIR , 
		SMNOTE_EXP , 
		SMNOTE_DROP , 
		SMNOTE_LEAK , 
		SMNOTE_NARR , 
		SMNOTE_COLL , 
		SMORDERTEXT1 , 
		SMORDERTEXT2 , 
		SMORJKCD , 
		SMORJKCDNM , 
		SMORNAME , 
		SMORSABUN , 
		SMGRJKCD , 
		SMGRJKCDNM , 
		SMGRNAME , 
		SMGRSABUN , 
		SMCOJKCD , 
		SMCOJKCDNM , 
		SMCONAME , 
		SMCOSABUN , 
		SMSMJKCD , 
		SMSMJKCDNM , 
		SMSMNAME , 
		SMSMSABUN , 
		SMOPJKCD , 
		SMOPJKCDNM , 
		SMOPNAME , 
		SMOPSABUN , 
		SMCHKOXYGENUNIT1 , 
		SMCHKTOXGUBN1 , 
		SMCHKTOXUNIT1 , 
		SMCHKTOXUNIT1DS , 
		SMCHKTOXUNIT1CO2 , 
		SMCHKTOXUNIT1CO , 
		SMCHKTOXUNIT1H2S , 
		SMCHKOXYGENUNIT2 , 
		SMCHKTOXGUBN2 , 
		SMCHKTOXUNIT2 , 
		SMCHKTOXUNIT2DS , 
		SMCHKTOXUNIT2CO2 , 
		SMCHKTOXUNIT2CO , 
		SMCHKTOXUNIT2H2S , 
		SMCHKOXYGENUNIT3 , 
		SMCHKTOXGUBN3 , 
		SMCHKTOXUNIT3 , 
		SMCHKTOXUNIT3DS , 
		SMCHKTOXUNIT3CO2 , 
		SMCHKTOXUNIT3CO , 
		SMCHKTOXUNIT3H2S , 
		SMCHKOXYGENUNIT4 , 
		SMCHKTOXGUBN4 , 
		SMCHKTOXUNIT4 , 
		SMCHKTOXUNIT4DS , 
		SMCHKTOXUNIT4CO2 , 
		SMCHKTOXUNIT4CO , 
		SMCHKTOXUNIT4H2S , 
		SMCHKOXYGENUNIT5 , 
		SMCHKTOXGUBN5 , 
		SMCHKTOXUNIT5 , 
		SMCHKTOXUNIT5DS , 
		SMCHKTOXUNIT5CO2 , 
		SMCHKTOXUNIT5CO , 
		SMCHKTOXUNIT5H2S , 
		SMCHKOXYGENUNIT6 , 
		SMCHKTOXGUBN6 , 
		SMCHKTOXUNIT6 , 
		SMCHKTOXUNIT6DS , 
		SMCHKTOXUNIT6CO2 , 
		SMCHKTOXUNIT6CO , 
		SMCHKTOXUNIT6H2S , 
		SMCHKOXYGENUNIT7 , 
		SMCHKTOXUNIT7 , 
		SMCHKTOXUNIT7DS , 
		SMCHKTOXUNIT7CO2 , 
		SMCHKTOXUNIT7CO , 
		SMCHKTOXUNIT7H2S , 
		SMCHKOXYGENUNIT8 , 
		SMCHKTOXUNIT8 , 
		SMCHKTOXUNIT8DS , 
		SMCHKTOXUNIT8CO2 , 
		SMCHKTOXUNIT8CO , 
		SMCHKTOXUNIT8H2S , 
		SMWORKTITLE , 
		SMFIREINS,
		SMHIGB , 
		SMHIDAT , 
		SMHITIM , 
		SMHISAB 
	) 
	SELECT 
		SMWKTEAM , 
		SMWKDATE , 
		SMWKSEQ , 
		SMWKORAPPDATE , 
		SMWKORSEQ , 
		SMMETHODCODE , 
		SMREVTEAM , 
		SMWKMETHOD , 
		SMSUBVEND , 
		SMSUBPERSON , 
		SMSUBTEL , 
		SMRESSABUN , 
		SMWKMAN , 
		SMTADATE1 , 
		SMTATIME1 , 
		SMTADATE2 , 
		SMTATIME2 , 
		SMOTDATE1 , 
		SMOTTIME1 , 
		SMOTDATE2 , 
		SMOTTIME2 , 
		SMOTAPPSABUN , 
		SMSYSTEMCODE1 , 
		SMSYSTEMCODE2 , 
		SMSYSTEMCODE3 , 
		SMSYSTEMCODE4 , 
		SMSYSTEMCODE5 , 
		SMCONNCODE11 , 
		SMCONNCODE12 , 
		SMCONNCODE21 , 
		SMCONNCODE22 , 
		SMCONNCODE31 , 
		SMCONNCODE32 , 
		SMCONNCODE41 , 
		SMCONNCODE42 , 
		SMCONNCODE51 , 
		SMCONNCODE52 , 
		SMAREACODE1 , 
		SMAREACODE2 , 
		SMAREACODE3 , 
		SMAREACODE4 , 
		SMAREACODE5 , 
		SMAREATEXT1 , 
		SMAREATEXT2 , 
		SMAREATEXT3 , 
		SMAREATEXT4 , 
		SMAREATEXT5 , 
		SMMATERTEXT1 , 
		SMMATERTEXT2 , 
		SMNOTE_BURN , 
		SMNOTE_SUFF , 
		SMNOTE_ELE , 
		SMNOTE_FIR , 
		SMNOTE_EXP , 
		SMNOTE_DROP , 
		SMNOTE_LEAK , 
		SMNOTE_NARR , 
		SMNOTE_COLL , 
		SMORDERTEXT1 , 
		SMORDERTEXT2 , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMORJKCD ELSE '' END ) AS SMORJKCD , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMORJKCDNM ELSE '' END ) AS SMORJKCDNM , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMORNAME ELSE '' END ) AS SMORNAME , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMORSABUN ELSE SMHISAB END ) AS SMORSABUN , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMGRJKCD ELSE '' END ) AS SMGRJKCD , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMGRJKCDNM ELSE '' END ) AS SMGRJKCDNM , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMGRNAME ELSE '' END ) AS SMGRNAME , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMGRSABUN ELSE '' END ) AS SMGRSABUN , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMCOJKCD ELSE '' END ) AS SMCOJKCD , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMCOJKCDNM ELSE '' END ) AS SMCOJKCDNM , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMCONAME ELSE '' END ) AS SMCONAME , 
		( CASE WHEN SMHISAB = SMORSABUN THEN SMCOSABUN ELSE '' END ) AS SMCOSABUN , 
		SMSMJKCD , 
		SMSMJKCDNM , 
		SMSMNAME , 
		SMSMSABUN , 
		SMOPJKCD , 
		SMOPJKCDNM , 
		SMOPNAME , 
		SMOPSABUN , 
		SMCHKOXYGENUNIT1 , 
		SMCHKTOXGUBN1 , 
		SMCHKTOXUNIT1 , 
		SMCHKTOXUNIT1DS , 
		SMCHKTOXUNIT1CO2 , 
		SMCHKTOXUNIT1CO , 
		SMCHKTOXUNIT1H2S , 
		SMCHKOXYGENUNIT2 , 
		SMCHKTOXGUBN2 , 
		SMCHKTOXUNIT2 , 
		SMCHKTOXUNIT2DS , 
		SMCHKTOXUNIT2CO2 , 
		SMCHKTOXUNIT2CO , 
		SMCHKTOXUNIT2H2S , 
		SMCHKOXYGENUNIT3 , 
		SMCHKTOXGUBN3 , 
		SMCHKTOXUNIT3 , 
		SMCHKTOXUNIT3DS , 
		SMCHKTOXUNIT3CO2 , 
		SMCHKTOXUNIT3CO , 
		SMCHKTOXUNIT3H2S , 
		SMCHKOXYGENUNIT4 , 
		SMCHKTOXGUBN4 , 
		SMCHKTOXUNIT4 , 
		SMCHKTOXUNIT4DS , 
		SMCHKTOXUNIT4CO2 , 
		SMCHKTOXUNIT4CO , 
		SMCHKTOXUNIT4H2S , 
		SMCHKOXYGENUNIT5 , 
		SMCHKTOXGUBN5 , 
		SMCHKTOXUNIT5 , 
		SMCHKTOXUNIT5DS , 
		SMCHKTOXUNIT5CO2 , 
		SMCHKTOXUNIT5CO , 
		SMCHKTOXUNIT5H2S , 
		SMCHKOXYGENUNIT6 , 
		SMCHKTOXGUBN6 , 
		SMCHKTOXUNIT6 , 
		SMCHKTOXUNIT6DS , 
		SMCHKTOXUNIT6CO2 , 
		SMCHKTOXUNIT6CO , 
		SMCHKTOXUNIT6H2S , 
		SMCHKOXYGENUNIT7 , 
		SMCHKTOXUNIT7 , 
		SMCHKTOXUNIT7DS , 
		SMCHKTOXUNIT7CO2 , 
		SMCHKTOXUNIT7CO , 
		SMCHKTOXUNIT7H2S , 
		SMCHKOXYGENUNIT8 , 
		SMCHKTOXUNIT8 , 
		SMCHKTOXUNIT8DS , 
		SMCHKTOXUNIT8CO2 , 
		SMCHKTOXUNIT8CO , 
		SMCHKTOXUNIT8H2S , 
		SMWORKTITLE , 
		SMFIREINS,
		SMHIGB , 
		SMHIDAT , 
		SMHITIM , 
		SMHISAB 
	FROM 
	( 
		SELECT 
			SMWKTEAM , 
			SMWKDATE , 
			SMWKSEQ , 
			CAST ( P_COPYDATE AS VARCHAR ( 8 ) ) AS SMWKORAPPDATE , 
			CAST ( P_NEW_SMWKORSEQ AS VARCHAR ( 3 ) ) AS SMWKORSEQ , 
			SMMETHODCODE , 
			SMREVTEAM , 
			SMWKMETHOD , 
			SMSUBVEND , 
			SMSUBPERSON , 
			SMSUBTEL , 
			SMRESSABUN , 
			SMWKMAN , 
			CAST ( P_COPYDATE AS VARCHAR ( 8 ) ) AS SMTADATE1 , 
			SMTATIME1 , 
			CAST ( P_COPYDATE AS VARCHAR ( 8 ) ) AS SMTADATE2 , 
			SMTATIME2 , 
			'' AS SMOTDATE1 , 
			'' AS SMOTTIME1 , 
			'' AS SMOTDATE2 , 
			'' AS SMOTTIME2 , 
			'' AS SMOTAPPSABUN , 
			SMSYSTEMCODE1 , 
			SMSYSTEMCODE2 , 
			SMSYSTEMCODE3 , 
			SMSYSTEMCODE4 , 
			SMSYSTEMCODE5 , 
			SMCONNCODE11 , 
			SMCONNCODE12 , 
			SMCONNCODE21 , 
			SMCONNCODE22 , 
			SMCONNCODE31 , 
			SMCONNCODE32 , 
			SMCONNCODE41 , 
			SMCONNCODE42 , 
			SMCONNCODE51 , 
			SMCONNCODE52 , 
			SMAREACODE1 , 
			SMAREACODE2 , 
			SMAREACODE3 , 
			SMAREACODE4 , 
			SMAREACODE5 , 
			SMAREATEXT1 , 
			SMAREATEXT2 , 
			SMAREATEXT3 , 
			SMAREATEXT4 , 
			SMAREATEXT5 , 
			SMMATERTEXT1 , 
			SMMATERTEXT2 , 
			SMNOTE_BURN , 
			SMNOTE_SUFF , 
			SMNOTE_ELE , 
			SMNOTE_FIR , 
			SMNOTE_EXP , 
			SMNOTE_DROP , 
			SMNOTE_LEAK , 
			SMNOTE_NARR , 
			SMNOTE_COLL , 
			SMORDERTEXT1 , 
			SMORDERTEXT2 , 
			SMORJKCD , 
			SMORJKCDNM , 
			SMORNAME , 
			SMORSABUN , 
			SMGRJKCD , 
			SMGRJKCDNM , 
			SMGRNAME , 
			SMGRSABUN , 
			SMCOJKCD , 
			SMCOJKCDNM , 
			SMCONAME , 
			SMCOSABUN , 
			SMSMJKCD , 
			SMSMJKCDNM , 
			SMSMNAME , 
			SMSMSABUN , 
			SMOPJKCD , 
			SMOPJKCDNM , 
			SMOPNAME , 
			SMOPSABUN , 
			'1' AS SMCHKOXYGENUNIT1 , 
			'' AS SMCHKTOXGUBN1 , 
			'1' AS SMCHKTOXUNIT1 , 
			'2' AS SMCHKTOXUNIT1DS , 
			'1' AS SMCHKTOXUNIT1CO2 , 
			'2' AS SMCHKTOXUNIT1CO , 
			'2' AS SMCHKTOXUNIT1H2S , 
			'1' AS SMCHKOXYGENUNIT2 , 
			'' AS SMCHKTOXGUBN2 , 
			'1' AS SMCHKTOXUNIT2 , 
			'2' AS SMCHKTOXUNIT2DS , 
			'1' AS SMCHKTOXUNIT2CO2 , 
			'2' AS SMCHKTOXUNIT2CO , 
			'2' AS SMCHKTOXUNIT2H2S , 
			'1' AS SMCHKOXYGENUNIT3 , 
			'' AS SMCHKTOXGUBN3 , 
			'1' AS SMCHKTOXUNIT3 , 
			'2' AS SMCHKTOXUNIT3DS , 
			'1' AS SMCHKTOXUNIT3CO2 , 
			'2' AS SMCHKTOXUNIT3CO , 
			'2' AS SMCHKTOXUNIT3H2S , 
			'1' AS SMCHKOXYGENUNIT4 , 
			'' AS SMCHKTOXGUBN4 , 
			'1' AS SMCHKTOXUNIT4 , 
			'2' AS SMCHKTOXUNIT4DS , 
			'1' AS SMCHKTOXUNIT4CO2 , 
			'2' AS SMCHKTOXUNIT4CO , 
			'2' AS SMCHKTOXUNIT4H2S , 
			'1' AS SMCHKOXYGENUNIT5 , 
			'' AS SMCHKTOXGUBN5 , 
			'1' AS SMCHKTOXUNIT5 , 
			'2' AS SMCHKTOXUNIT5DS , 
			'1' AS SMCHKTOXUNIT5CO2 , 
			'2' AS SMCHKTOXUNIT5CO , 
			'2' AS SMCHKTOXUNIT5H2S , 
			'1' AS SMCHKOXYGENUNIT6 , 
			'' AS SMCHKTOXGUBN6 , 
			'1' AS SMCHKTOXUNIT6 , 
			'2' AS SMCHKTOXUNIT6DS , 
			'1' AS SMCHKTOXUNIT6CO2 , 
			'2' AS SMCHKTOXUNIT6CO , 
			'2' AS SMCHKTOXUNIT6H2S , 
			'1' AS SMCHKOXYGENUNIT7 , 
			'1' AS SMCHKTOXUNIT7 , 
			'2' AS SMCHKTOXUNIT7DS , 
			'1' AS SMCHKTOXUNIT7CO2 , 
			'2' AS SMCHKTOXUNIT7CO , 
			'2' AS SMCHKTOXUNIT7H2S , 
			'1' AS SMCHKOXYGENUNIT8 , 
			'1' AS SMCHKTOXUNIT8 , 
			'2' AS SMCHKTOXUNIT8DS , 
			'1' AS SMCHKTOXUNIT8CO2 , 
			'2' AS SMCHKTOXUNIT8CO , 
			'2' AS SMCHKTOXUNIT8H2S , 
			SMWORKTITLE , 
			SMFIREINS,
			'A' AS SMHIGB , 
			CURRENT_DATE AS SMHIDAT , 
			CURRENT_TIME AS SMHITIM , 
			CAST ( P_SABUN AS VARCHAR ( 6 ) ) AS SMHISAB 
		FROM PSSCMLIB . PSM_SAFEORDER_MASTER 
		WHERE SMWKTEAM = P_SMWKTEAM 
		AND SMWKDATE = P_SMWKDATE 
		AND SMWKSEQ = P_SMWKSEQ 
		AND SMWKORAPPDATE = P_SMWKORAPPDATE 
		AND SMWKORSEQ = P_SMWKORSEQ 
	) AS TEMP ; 
  
  
  
  
	IF EXISTS ( SELECT SSWKTEAM FROM PSSCMLIB . PSM_SAFEORDER_SACODE WHERE SSWKTEAM = P_SMWKTEAM 
	AND SSWKDATE = P_SMWKDATE 
								AND SSWKSEQ = P_SMWKSEQ 
								AND SSORAPPDATE = P_SMWKORAPPDATE 
								AND SSORSEQ = P_SMWKORSEQ ) THEN 
  
		INSERT INTO PSSCMLIB . PSM_SAFEORDER_SACODE 
		( 
			SSWKTEAM , 
			SSWKDATE , 
			SSWKSEQ , 
			SSORAPPDATE , 
			SSORSEQ , 
			SSSACODE , 
			SSCODENAME , 
			SSPUBSEL , 
			SSHIGB , 
			SSHIDAT , 
			SSHITIM , 
			SSHISAB 
		) 
		SELECT 
			SSWKTEAM , 
			SSWKDATE , 
			SSWKSEQ , 
			CAST ( P_COPYDATE AS VARCHAR ( 8 ) ) AS SSORAPPDATE , 
			CAST ( P_NEW_SMWKORSEQ AS VARCHAR ( 3 ) ) AS SSORSEQ , 
			SSSACODE , 
			SSCODENAME , 
			SSPUBSEL , 
			'A' , 
			CURRENT_DATE , 
			CURRENT_TIME , 
			CAST ( P_SABUN AS VARCHAR ( 6 ) ) AS SSHISAB 
		FROM PSSCMLIB . PSM_SAFEORDER_SACODE 
		WHERE SSWKTEAM = P_SMWKTEAM 
		AND SSWKDATE = P_SMWKDATE 
		AND SSWKSEQ = P_SMWKSEQ 
		AND SSORAPPDATE = P_SMWKORAPPDATE 
		AND SSORSEQ = P_SMWKORSEQ ; 
  
	END IF ; 
  
	IF EXISTS ( SELECT SWWKTEAM FROM PSSCMLIB . PSM_SAFEORDER_WKCODE WHERE SWWKTEAM = P_SMWKTEAM 
	AND SWWKDATE = P_SMWKDATE 
								AND SWWKSEQ = P_SMWKSEQ 
								AND SWORAPPDATE = P_SMWKORAPPDATE 
								AND SWORSEQ = P_SMWKORSEQ ) THEN 
  
		INSERT INTO PSSCMLIB . PSM_SAFEORDER_WKCODE 
		( 
			SWWKTEAM , 
			SWWKDATE , 
			SWWKSEQ , 
			SWORAPPDATE , 
			SWORSEQ , 
			SWWKCODE , 
			SWWKNAME , 
			SWRISKRATE , 
			SWCHECKGN , 
			SWHIGB , 
			SWHIDAT , 
			SWHITIM , 
			SWHISAB 
		) 
		SELECT 
			SWWKTEAM , 
			SWWKDATE , 
			SWWKSEQ , 
			CAST ( P_COPYDATE AS VARCHAR ( 8 ) ) AS SWORAPPDATE , 
			CAST ( P_NEW_SMWKORSEQ AS VARCHAR ( 3 ) ) AS SWORSEQ , 
			SWWKCODE , 
			SWWKNAME , 
			SWRISKRATE , 
			SWCHECKGN , 
			'A' , 
			CURRENT_DATE , 
			CURRENT_TIME , 
			CAST ( P_SABUN AS VARCHAR ( 6 ) ) AS SWHISAB 
		FROM PSSCMLIB . PSM_SAFEORDER_WKCODE 
		WHERE SWWKTEAM = P_SMWKTEAM 
		AND SWWKDATE = P_SMWKDATE 
		AND SWWKSEQ = P_SMWKSEQ 
		AND SWORAPPDATE = P_SMWKORAPPDATE 
		AND SWORSEQ = P_SMWKORSEQ ; 
  
	END IF ; 
  
END P1;