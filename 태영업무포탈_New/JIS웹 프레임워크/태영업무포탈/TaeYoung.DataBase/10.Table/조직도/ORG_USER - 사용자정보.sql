DROP VIEW TYJINFWLIB.ORG_USER;
-- 사용자정보
-- 이전 테이블 명 : PTORGUSR70
-- TB_User
CREATE VIEW TYJINFWLIB.ORG_USER
AS

SELECT
	'TY' AS COMPANYCODE,
   KBSABUN AS EMPID,
   KBMAILID AS LOGINID,
   '' AS ALIAS,
   KBMAILID AS EMAIL,
   KBBSTEAM AS MAINDEPTCODE,
   '' AS CREATEDDT,
   '' AS LEGACYEXCHANGEDN,
   KBHANGL AS DISPLAYNAME,
   'Y' AS DISPLAYYN,
   '' AS ROLETYPE,
   KBJKCD AS DUTYCODE,
   'N' AS JOBCODE,
   KBJCCD AS RANKCODE,
   KBMOBILE AS CELLPHONE,
   KBCOMFAX AS FAXNUMBER,
   KBCOMTEL AS EXTENSIONNUMBER,
   '' AS LOCATIONCODE,
   '' AS TEAMCHIEFYN,
   KBBIRTH AS DATEOFBIRTH,
   '' AS IFYN,
   '' AS MESSANGERIFYN,
   '' AS PHONE1,
   '' AS PHONE2,
   '' AS CULTURE,
   '' AS ORG_CD,
    '' AS REGID,
	'' AS REGDT,
	'' AS UPDID,
	'' AS UPDDT,
	'' AS SAPID,
	'' AS SAPMNGYN,
	'' AS KOSTL,
	'' AS VALID_YN,
	'' AS JOBDESC,
	'0' AS DPARTNER,
	'' AS ONSITE,
    '' AS SITECOMPANY,
	'' AS EMPERNAME
FROM TYSCMLIB.INKIBNMF
WHERE KBBALCD NOT IN ('900','560')
UNION ALL
SELECT CASE WHEN EMGUBUN = 'T' THEN 'UT' 
       ELSE 'US' END  COMPANYCODE,
        EMUSERID AS EMPID,
	     EMUSERID AS LOGINID,
	   '' AS ALIAS,
	   '' AS EMAIL,
	   CASE WHEN EMGUBUN = 'T' THEN 'T10000' 
       ELSE 'S10000' END AS MAINDEPTCODE,
	   '' AS CREATEDDT,
	   '' AS LEGACYEXCHANGEDN,
	   CASE WHEN VNSANGHO IS NOT  NULL THEN 
	       VNSANGHO
	   ELSE 
	       EMISANGHO
	   END AS DISPLAYNAME,
	   'Y' AS DISPLAYYN,
	   '' AS ROLETYPE,
	   '' AS DUTYCODE,
	   EMDELIVERY AS JOBCODE,
	   '' AS RANKCODE,
	   '' AS CELLPHONE,
	   '' AS FAXNUMBER,
	   '' AS EXTENSIONNUMBER,
	   '' AS LOCATIONCODE,
	   '' AS TEAMCHIEFYN,
	   '' AS DATEOFBIRTH,
	   '' AS IFYN,
	   '' AS MESSANGERIFYN,
	   '' AS PHONE1,
	   '' AS PHONE2,
	   '' AS CULTURE,
	   '' AS ORG_CD,
	    '' AS REGID,
		'' AS REGDT,
		'' AS UPDID,
		'' AS UPDDT,
		'' AS SAPID,
		'' AS SAPMNGYN,
		TYJINFWLIB.SF_GET_VNCODE(EMGUBUN,EMHWAJU) AS KOSTL,
		'' AS VALID_YN,
		'' AS JOBDESC,
		'1' AS DPARTNER,
		'' AS ONSITE,
	    '' AS SITECOMPANY,
		EMNAME AS EMPERNAME
FROM TYSCMLIB.WEDIUSEF
LEFT OUTER JOIN TYSCMLIB.UTIVENDF
   ON   VNCODE = CASE WHEN EMGUBUN = 'T' THEN EMHWAJU ELSE '' END 
UNION ALL
SELECT 'TG' AS COMPANYCODE,
        EMUSERID AS EMPID,
        EMUSERID AS LOGINID,
	   '' AS ALIAS,
	   '' AS EMAIL,
	 'G10000' AS MAINDEPTCODE,
	   '' AS CREATEDDT,
	   '' AS LEGACYEXCHANGEDN,
	   EMUSNAME AS DISPLAYNAME,
	   'Y' AS DISPLAYYN,
	   '' AS ROLETYPE,
	   '' AS DUTYCODE,
	   'N' AS JOBCODE,
	   '' AS RANKCODE,
	   '' AS CELLPHONE,
	   '' AS FAXNUMBER,
	   '' AS EXTENSIONNUMBER,
	   '' AS LOCATIONCODE,
	   '' AS TEAMCHIEFYN,
	   '' AS DATEOFBIRTH,
	   '' AS IFYN,
	   '' AS MESSANGERIFYN,
	   '' AS PHONE1,
	   '' AS PHONE2,
	   '' AS CULTURE,
	   '' AS ORG_CD,
	    '' AS REGID,
		'' AS REGDT,
		'' AS UPDID,
		'' AS UPDDT,
		'' AS SAPID,
		'' AS SAPMNGYN,
		EMHWAJU AS KOSTL,
		'' AS VALID_YN,
		'' AS JOBDESC,
		'1' AS DPARTNER,
		'' AS ONSITE,
	    '' AS SITECOMPANY, 
		'' AS EMPERNAME 
FROM TGSCMLIB.WEDIUSEF

